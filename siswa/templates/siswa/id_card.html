{% extends 'base.html' %}
{% load static qr_code %}

{% block extra_css %}
    <style>
        .id-card {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            max-width: 319px;
            margin: auto;
            text-align: center;
            height: 505px;
        }
    </style>
{% endblock %}

{% block sidebar_menu %}
    {% include 'siswa/sidebar.html' %}
{% endblock %}

{% block title %}
    {{ title_page }}
{% endblock %}

{% block content %}
    <div class="page-heading">
        <div class="page-title">
            <div class="row mb-3">
                <div class="col-12 col-md-6 order-md-1 order-first">
                    <h3>{{ title_page }}</h3>
                    <p class="text-subtitle text-muted">{{ sub_title_page }}</p>
                </div>
                <div class="col-12 col-md-6 order-md-2 order-last">

                </div>
            </div>
        </div>

        <section class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-body text-center">
                        <div class="id-card" id="IDCard">
                            <div style="background-image: url('{% static 'assets/images/samples/origami.jpg' %}'); background-size: cover;">
                                <img src="{{ object.get_foto }}" alt="avatar"
                                class="rounded-circle img-fluid m-3" style="width: 100px;">

                                <span class="badge bg-primary">Siswa</span>
                            </div>
                            <h4 class="mt-3">{{ object.nama }}</h4>
                            <p class="text-secondary text-sm mb-0">NIS: {{ object.nis }}</p>
                            <p class="text-secondary text-sm">Alamat: {{ object.alamat }}</p>
                            {% qr_from_text object.nis size=13 %}
                            <hr>
                            <h5>
                                {{ object.sekolah }}
                            </h5>
                            <p class="mt-0 text-sm">{{ object.sekolah.get_alamat }}</p>
                        </div>
                        <button class="btn btn-primary mt-4" id="download-id-card" onclick="downloadIDCard()"> Download </button>
                    </div>
                </div>
            </div>
        </section>
    </div>

{% endblock %}


{% block extra_js %}
    <script src="{% static 'assets/js/extensions/html2canvas.min.js' %}"></script>
    <script>
        function downloadIDCard() {
            html2canvas(document.getElementById("IDCard")).then(function (canvas) {
                const anchorTag = document.createElement("a");
                document.body.appendChild(anchorTag);
                anchorTag.download = "{{ object.nama }}-{{ object.nis }}.jpg";
                anchorTag.href = canvas.toDataURL();
                anchorTag.target = '_blank';
                anchorTag.click();
            })
        }
    </script>
{% endblock %}